
<div style="width: 100%; display: flex; justify-content: center; ">
<div >
  <table  style="width: 500px;">
    <tr *ngFor="let row of tableData; let rowIndex = index" >
      <ng-container    
        *ngFor="let field of row; let colIndex = index" 
      >
        <td 
          *ngIf="field.visibility"
          [attr.rowspan]="getSpan(field).row"
          [attr.colspan]="getSpan(field).col"
          [class.selected]="isCellSelected(rowIndex, colIndex)"
          (mousedown)="startSelecting(rowIndex, colIndex)"
          (mouseup)="endSelecting(rowIndex, colIndex)"
          (mouseover)="updateSelection(rowIndex, colIndex)"
          (click)="handleCellClick(field)"
        >
          {{field.cell?.name || 'empty'}}
        </td>
      </ng-container>
    </tr>
  </table>

  <div >
    <button (click)="mergeCells()">Merge</button>
    <button (click)="undoMergeCells()">Undo Merge</button>
    <button (click)="generateMatrix()">Reset </button>
  </div>
</div>
 
</div>


<div>
  <span>startRange: {{ startRange | json}}</span>
  <span>endRange: {{ endRange | json }}</span>
  <span>updateRange: {{ updateRange | json }}</span>
  <span>isSelected: {{ isSelected | json }}</span>
</div>
<div>toMerge: {{ toMerge | json }}</div>
<strong>selectedRange: {{ selectedRange | json }}</strong>

<pre>{{this.testTable | json}}</pre>